@prefix :      <http://debs2015.org/streams/> .
@prefix xsd:   <http://www.w3.org/2001/XMLSchema#> .
@prefix debs:  <http://debs2015.org/onto#> .
@prefix sp:    <http://spinrdf.org/sp#> .
@prefix rsp:   <http://w3id.org/rsp/spin#> .

[ a                    sp:Select ;
  sp:resultVariables   ( [ sp:expression  [ a              sp:Count ;
                                            sp:expression  [ sp:varName  "ride"^^xsd:string ]
                                          ] ;
                           sp:varName     "rideCount"^^xsd:string
                         ] ) ;
  sp:where             ( [ a                   rsp:NamedWindow ;
                           sp:elements         ( [ sp:object     [ sp:varName  "distance"^^xsd:string ] ;
                                                   sp:predicate  debs:distance ;
                                                   sp:subject    [ sp:varName  "ride"^^xsd:string ]
                                                 ] [ a              sp:Filter ;
                                                     sp:expression  [ a        sp:gt ;
                                                                      sp:arg1  [ sp:varName  "distance"^^xsd:string ] ;
                                                                      sp:arg2  2
                                                                    ]
                                                   ] ) ;
                           rsp:windowNameNode  :win
                         ] ) ;
  rsp:fromNamedWindow  [ a                rsp:LogicalWindow ;
                         rsp:logicalStep  "PT1H"^^xsd:duration ;
                         rsp:range        "PT1H"^^xsd:duration ;
                         rsp:streamIri    :trips ;
                         rsp:windowIri    :win
                       ]
] .