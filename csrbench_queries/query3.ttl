PREFIX  :     <http://w3id.org/rsp/>
PREFIX  weather: <http://knoesis.wright.edu/ssw/ont/weather.owl#>
PREFIX  om-owl: <http://knoesis.wright.edu/ssw/ont/sensor-observation.owl#>
PREFIX  sens-obs: <http://knoesis.wright.edu/ssw/>

REGISTER STREAM :q4 AS 

SELECT  (avg(?value) AS ?avg)
FROM NAMED WINDOW :w ON :s [RANGE PT4S STEP PT4S]
WHERE
  { WINDOW :w
      { ?obs om-owl:observedProperty weather:AirTemperature .
        ?obs om-owl:procedure ?sensor .
        ?obs om-owl:result ?res .
        ?res om-owl:floatValue ?value
      }
    FILTER ( ?value > 80 )
  }
